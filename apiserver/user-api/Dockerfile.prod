FROM node:18-alpine AS development

WORKDIR /app

COPY yarn.lock package.json ./
RUN yarn install --frozen-lockfile

COPY . .

RUN yarn prisma generate
COPY prisma ./prisma/

RUN yarn run build

COPY ./start-prod.sh ./start-prod.sh

EXPOSE 3000

CMD chmod +x ./start-prod.sh && /bin/sh -c ./start-prod.sh